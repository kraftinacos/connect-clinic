<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Elixir">
    <meta name="theme-color" content="#0F172A">
    <title>Elixir</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { -webkit-tap-highlight-color: transparent; touch-action: manipulation; box-sizing: border-box; }
        html, body { max-width: 100vw; overflow-x: hidden; margin: 0; padding: 0; background: #0F172A; color: white; font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
        .safe-top { padding-top: env(safe-area-inset-top); }
        .safe-bottom { padding-bottom: calc(env(safe-area-inset-bottom) + 100px); }
        .btn-huge { min-height: 72px; border-radius: 24px; font-size: 24px; font-weight: 700; }
        .btn-profile { min-height: 72px; min-width: 72px; border-radius: 24px; font-size: 16px; font-weight: 700; padding: 8px 12px; flex: 1; }
        .btn-zoom { min-height: 72px; border-radius: 24px; font-size: 20px; font-weight: 700; background: #14B8A6; color: white; box-shadow: 0 4px 20px rgba(20,184,166,0.4); }
        .btn-zoom:active { transform: scale(0.98); background: #0D9488; }
        .btn-primary { background: #14B8A6; color: white; box-shadow: 0 4px 20px rgba(20,184,166,0.4); }
        .btn-primary:active { transform: scale(0.98); background: #0D9488; }
        .btn-secondary { background: #1E2937; color: white; border: 3px solid #334155; }
        .btn-secondary:active { transform: scale(0.98); background: #0F172A; }
        .btn-active { background: #14B8A6; color: white; border-color: #14B8A6; box-shadow: 0 4px 20px rgba(20,184,166,0.4); }
        .card { background: #1E2937; border-radius: 28px; padding: 28px; }
        .patient-card { background: #1E2937; border-radius: 28px; padding: 24px; margin-bottom: 16px; }
        .tab-active { color: #14B8A6; }
        .tab-inactive { color: #64748B; }
        .time-slot { min-height: 72px; border-radius: 20px; background: #1E2937; border: 3px solid #334155; font-size: 22px; font-weight: 600; }
        .time-slot.selected { background: #14B8A6; border-color: #14B8A6; color: white; }
        .day-pill { min-width: 64px; min-height: 88px; border-radius: 20px; font-size: 18px; }
        .day-pill.today { background: #14B8A6; color: white; box-shadow: 0 4px 20px rgba(20,184,166,0.4); }
        .day-pill.other { background: #1E2937; color: #94A3B8; border: 3px solid #334155; }
        #install-banner { position: fixed; bottom: 120px; left: 20px; right: 20px; background: #14B8A6; border-radius: 28px; padding: 28px; z-index: 1000; display: none; }
        #install-banner.show { display: block; animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { transform: translateY(100px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .hidden { display: none !important; }
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; display: none; align-items: center; justify-content: center; padding: 20px; }
        .modal.show { display: flex; }
        .modal-content { background: #1E2937; border-radius: 32px; width: 100%; max-height: 90vh; overflow-y: auto; padding: 28px; }
        input, select, textarea { background: #0F172A; border: 3px solid #334155; border-radius: 20px; color: white; min-height: 72px; padding: 0 24px; font-size: 22px; width: 100%; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: #14B8A6; }
        .stat-num { font-size: 44px; font-weight: 800; }
        .profile-bar { height: 80px; background: #0F172A; border-bottom: 3px solid #1E2937; padding: 8px 12px; }
    </style>
</head>
<body class="safe-top safe-bottom">
    <!-- Install Banner -->
    <div id="install-banner">
        <div class="flex items-center justify-between text-white">
            <div>
                <p class="font-bold text-2xl">Add to Home Screen</p>
                <p class="text-lg opacity-90 mt-2">Launch Elixir as native app</p>
            </div>
            <button onclick="addToHomeScreen()" class="bg-white text-slate-900 px-8 py-5 rounded-3xl font-bold text-xl">ADD</button>
        </div>
    </div>

    <!-- Profile Switcher Bar -->
    <div class="profile-bar flex items-center gap-2 sticky top-0 z-50">
        <button onclick="switchProfile('dr-smith')" class="btn-profile btn-secondary" id="btn-dr-smith">Dr<br>Smith</button>
        <button onclick="switchProfile('dr-lee')" class="btn-profile btn-secondary" id="btn-dr-lee">Dr<br>Lee</button>
        <button onclick="switchProfile('nurse-kim')" class="btn-profile btn-secondary" id="btn-nurse-kim">Nurse<br>Kim</button>
        <button onclick="switchProfile('admin-taylor')" class="btn-profile btn-secondary" id="btn-admin-taylor">Admin<br>Taylor</button>
    </div>

    <!-- Header -->
    <header class="bg-slate-900 px-6 py-4 flex items-center justify-between">
        <div class="flex items-center gap-4">
            <div class="w-14 h-14 bg-teal-500 rounded-2xl flex items-center justify-center text-white font-bold text-2xl">E</div>
            <div>
                <span class="font-bold text-2xl">Elixir</span>
                <div class="text-teal-400 text-sm" id="current-user">Dr Smith</div>
            </div>
        </div>
    </header>

    <!-- Week Range -->
    <div class="px-6 py-3 text-center">
        <span class="text-slate-400 text-lg" id="week-range">Mon 16 Feb - Sun 22 Feb 2026</span>
    </div>

    <!-- Stats Cards -->
    <div class="px-6 py-3 grid grid-cols-3 gap-3">
        <div class="card text-center py-4">
            <div class="stat-num text-teal-400" id="stat-today">0</div>
            <div class="text-base text-slate-400 mt-1">Today</div>
        </div>
        <div class="card text-center py-4">
            <div class="stat-num text-teal-400" id="stat-tasks">0</div>
            <div class="text-base text-slate-400 mt-1">Tasks</div>
        </div>
        <div class="card text-center py-4">
            <div class="stat-num text-teal-400" id="stat-recalls">0</div>
            <div class="text-base text-slate-400 mt-1">Recalls</div>
        </div>
    </div>

    <!-- Week Selector -->
    <div class="px-6 py-3 overflow-x-auto">
        <div class="flex gap-2 min-w-max">
            <button class="day-pill other flex flex-col items-center justify-center" onclick="selectDay('Mon', 16)">
                <span class="text-sm">Mon</span>
                <span class="font-bold text-xl">16</span>
            </button>
            <button class="day-pill other flex flex-col items-center justify-center" onclick="selectDay('Tue', 17)">
                <span class="text-sm">Tue</span>
                <span class="font-bold text-xl">17</span>
            </button>
            <button class="day-pill other flex flex-col items-center justify-center" onclick="selectDay('Wed', 18)">
                <span class="text-sm">Wed</span>
                <span class="font-bold text-xl">18</span>
            </button>
            <button class="day-pill other flex flex-col items-center justify-center" onclick="selectDay('Thu', 19)">
                <span class="text-sm">Thu</span>
                <span class="font-bold text-xl">19</span>
            </button>
            <button class="day-pill today flex flex-col items-center justify-center" onclick="selectDay('Fri', 20)">
                <span class="text-sm">Fri</span>
                <span class="font-bold text-xl">20</span>
            </button>
            <button class="day-pill other flex flex-col items-center justify-center" onclick="selectDay('Sat', 21)">
                <span class="text-sm">Sat</span>
                <span class="font-bold text-xl">21</span>
            </button>
            <button class="day-pill other flex flex-col items-center justify-center" onclick="selectDay('Sun', 22)">
                <span class="text-sm">Sun</span>
                <span class="font-bold text-xl">22</span>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="px-6 pb-40">
        <!-- Schedule View -->
        <div id="view-schedule" class="view-section">
            <button onclick="openBookingModal()" class="btn-huge btn-primary w-full mb-4 flex items-center justify-center gap-2">
                <span class="text-3xl">+</span> Book
            </button>
            
            <div class="card text-center py-8" id="empty-state">
                <div class="text-7xl mb-4">üìÖ</div>
                <h3 class="font-bold text-2xl mb-2">No appointments</h3>
                <p class="text-slate-400 text-lg">Tap Book to add</p>
            </div>

            <div id="appointments-list" class="space-y-3 hidden">
                <!-- Appointments injected here -->
            </div>
        </div>

        <!-- Day List View -->
        <div id="view-daylist" class="view-section hidden">
            <div class="card text-center py-10">
                <div class="text-7xl mb-4">üìã</div>
                <h3 class="font-bold text-2xl mb-2">Day List</h3>
                <p class="text-slate-400 text-lg">Queue appears here</p>
            </div>
        </div>

        <!-- Patients View -->
        <div id="view-patients" class="view-section hidden">
            <input type="text" id="patient-search" placeholder="üîç Search patients" class="mb-4" oninput="searchPatients(this.value)">
            <div id="patients-list" class="space-y-4">
                <!-- Patients injected here -->
            </div>
        </div>

        <!-- Office View -->
        <div id="view-office" class="view-section hidden">
            <div class="card text-center py-10">
                <div class="text-7xl mb-4">üè¢</div>
                <h3 class="font-bold text-2xl mb-2">Office</h3>
                <p class="text-slate-400 text-lg">Management tools</p>
            </div>
        </div>

        <!-- Tasks View -->
        <div id="view-tasks" class="view-section hidden">
            <button onclick="addTask()" class="btn-huge btn-primary w-full mb-4">+ Task</button>
            <div id="tasks-list" class="space-y-3">
                <!-- Tasks injected here -->
            </div>
        </div>
    </main>

    <!-- Booking Modal -->
    <div id="booking-modal" class="modal">
        <div class="modal-content">
            <h2 class="font-bold text-3xl mb-6">New Booking</h2>
            
            <label class="block text-slate-400 mb-2 text-lg">Patient</label>
            <input type="text" id="booking-patient" placeholder="Name" class="mb-4">
            
            <label class="block text-slate-400 mb-2 text-lg">Date</label>
            <input type="date" id="booking-date" class="mb-4">
            
            <label class="block text-slate-400 mb-2 text-lg">Time</label>
            <div class="grid grid-cols-2 gap-3 mb-6">
                <button class="time-slot flex items-center justify-center" onclick="selectTime(this, '08:00')">8:00</button>
                <button class="time-slot flex items-center justify-center" onclick="selectTime(this, '09:00')">9:00</button>
                <button class="time-slot flex items-center justify-center" onclick="selectTime(this, '10:00')">10:00</button>
                <button class="time-slot flex items-center justify-center" onclick="selectTime(this, '11:00')">11:00</button>
                <button class="time-slot flex items-center justify-center" onclick="selectTime(this, '14:00')">14:00</button>
                <button class="time-slot flex items-center justify-center" onclick="selectTime(this, '15:00')">15:00</button>
                <button class="time-slot flex items-center justify-center" onclick="selectTime(this, '16:00')">16:00</button>
            </div>
            
            <div class="flex gap-3">
                <button onclick="closeBookingModal()" class="btn-huge btn-secondary flex-1">Cancel</button>
                <button onclick="saveAppointment()" class="btn-huge btn-primary flex-1">Save</button>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="modal">
        <div class="modal-content text-center">
            <div class="text-7xl mb-4">‚úÖ</div>
            <h2 class="font-bold text-3xl mb-3">Saved!</h2>
            <p class="text-slate-400 text-xl mb-6" id="success-message">Appointment booked</p>
            <button onclick="closeSuccessModal()" class="btn-huge btn-primary w-full">Done</button>
        </div>
    </div>

    <!-- Patient Modal -->
    <div id="patient-modal" class="modal">
        <div class="modal-content">
            <h2 class="font-bold text-3xl mb-4" id="patient-name">Patient</h2>
            <p class="text-slate-400 text-lg mb-6" id="patient-phone"></p>
            <div class="space-y-3">
                <button onclick="callPatientZoom()" class="btn-zoom w-full flex items-center justify-center gap-3">
                    <span class="text-3xl">üìû</span> Call in Zoom
                </button>
                <button class="btn-huge btn-primary w-full">üìã Records</button>
                <button class="btn-huge btn-primary w-full">üíä Prescribe</button>
                <button class="btn-huge btn-secondary w-full" onclick="closePatientModal()">Back</button>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-slate-900 border-t-4 border-slate-800 px-2 py-3 safe-bottom z-50">
        <div class="flex justify-around items-center">
            <button onclick="switchTab('schedule')" class="tab-btn flex flex-col items-center gap-1 p-2 tab-active" data-tab="schedule">
                <span class="text-3xl">üìÖ</span>
                <span class="text-sm font-bold">Book</span>
            </button>
            <button onclick="switchTab('daylist')" class="tab-btn flex flex-col items-center gap-1 p-2 tab-inactive" data-tab="daylist">
                <span class="text-3xl">üìã</span>
                <span class="text-sm font-bold">List</span>
            </button>
            <button onclick="switchTab('patients')" class="tab-btn flex flex-col items-center gap-1 p-2 tab-inactive" data-tab="patients">
                <span class="text-3xl">üë§</span>
                <span class="text-sm font-bold">Patients</span>
            </button>
            <button onclick="switchTab('office')" class="tab-btn flex flex-col items-center gap-1 p-2 tab-inactive" data-tab="office">
                <span class="text-3xl">üè¢</span>
                <span class="text-sm font-bold">Office</span>
            </button>
            <button onclick="switchTab('tasks')" class="tab-btn flex flex-col items-center gap-1 p-2 tab-inactive" data-tab="tasks">
                <span class="text-3xl">‚úì</span>
                <span class="text-sm font-bold">Tasks</span>
            </button>
        </div>
    </nav>

    <script>
        // State
        let selectedTime = null;
        let currentProfile = localStorage.getItem('elixir_current_profile') || 'dr-smith';
        let currentPatientPhone = null;
        
        const profileNames = {
            'dr-smith': 'Dr Smith',
            'dr-lee': 'Dr Lee',
            'nurse-kim': 'Nurse Kim',
            'admin-taylor': 'Admin Taylor'
        };
        
        // Patient data with phone numbers
        const patientsData = [
            { name: 'John Smith', phone: '+64 21 123 4567' },
            { name: 'Sarah Lee', phone: '+64 22 234 5678' },
            { name: 'Mike Chen', phone: '+64 27 345 6789' },
            { name: 'Emma Wilson', phone: '+64 21 456 7890' },
            { name: 'David Park', phone: '+64 22 567 8901' },
            { name: 'Lisa Wong', phone: '+64 27 678 9012' }
        ];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateProfileButtons();
            loadAppointments();
            loadTasks();
            updateStats();
            renderPatientsList(patientsData);
            
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('booking-date').value = today;
            
            if (!window.navigator.standalone && !window.matchMedia('(display-mode: standalone)').matches) {
                setTimeout(() => {
                    document.getElementById('install-banner').classList.add('show');
                }, 2000);
            }
        });
        
        // Profile Functions
        function switchProfile(profileId) {
            currentProfile = profileId;
            localStorage.setItem('elixir_current_profile', profileId);
            document.getElementById('current-user').textContent = profileNames[profileId];
            updateProfileButtons();
            loadAppointments();
            loadTasks();
            updateStats();
        }
        
        function updateProfileButtons() {
            document.querySelectorAll('.btn-profile').forEach(btn => {
                btn.classList.remove('btn-active');
                btn.classList.add('btn-secondary');
            });
            const activeBtn = document.getElementById('btn-' + currentProfile);
            if (activeBtn) {
                activeBtn.classList.remove('btn-secondary');
                activeBtn.classList.add('btn-active');
            }
            document.getElementById('current-user').textContent = profileNames[currentProfile];
        }
        
        function getStorageKey(key) {
            return `elixir_${currentProfile}_${key}`;
        }
        
        // Tab Switching
        function switchTab(tabName) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
            document.getElementById('view-' + tabName).classList.remove('hidden');
            
            document.querySelectorAll('.tab-btn').forEach(btn => {
                if (btn.dataset.tab === tabName) {
                    btn.classList.remove('tab-inactive');
                    btn.classList.add('tab-active');
                } else {
                    btn.classList.remove('tab-active');
                    btn.classList.add('tab-inactive');
                }
            });
        }
        
        function selectDay(day, date) {
            document.querySelectorAll('.day-pill').forEach(pill => {
                pill.classList.remove('today');
                pill.classList.add('other');
            });
            event.currentTarget.classList.remove('other');
            event.currentTarget.classList.add('today');
            loadAppointments();
        }
        
        // Booking
        function openBookingModal() {
            document.getElementById('booking-modal').classList.add('show');
        }
        
        function closeBookingModal() {
            document.getElementById('booking-modal').classList.remove('show');
            selectedTime = null;
            document.querySelectorAll('.time-slot').forEach(slot => slot.classList.remove('selected'));
            document.getElementById('booking-patient').value = '';
        }
        
        function selectTime(element, time) {
            document.querySelectorAll('.time-slot').forEach(slot => slot.classList.remove('selected'));
            element.classList.add('selected');
            selectedTime = time;
        }
        
        function saveAppointment() {
            const patient = document.getElementById('booking-patient').value;
            const date = document.getElementById('booking-date').value;
            
            if (!patient || !selectedTime) {
                alert('Enter name and time');
                return;
            }
            
            const appointment = {
                id: Date.now(),
                patient: patient,
                date: date,
                time: selectedTime,
                created: new Date().toISOString()
            };
            
            let appointments = JSON.parse(localStorage.getItem(getStorageKey('appointments')) || '[]');
            appointments.push(appointment);
            localStorage.setItem(getStorageKey('appointments'), JSON.stringify(appointments));
            
            closeBookingModal();
            document.getElementById('success-message').textContent = `Booked ${patient} at ${selectedTime}`;
            document.getElementById('success-modal').classList.add('show');
            loadAppointments();
            updateStats();
        }
        
        function closeSuccessModal() {
            document.getElementById('success-modal').classList.remove('show');
        }
        
        // Appointments
        function loadAppointments() {
            const appointments = JSON.parse(localStorage.getItem(getStorageKey('appointments')) || '[]');
            const list = document.getElementById('appointments-list');
            const emptyState = document.getElementById('empty-state');
            const today = new Date().toISOString().split('T')[0];
            const todays = appointments.filter(a => a.date === today);
            
            if (todays.length === 0) {
                list.classList.add('hidden');
                emptyState.classList.remove('hidden');
                return;
            }
            
            list.classList.remove('hidden');
            emptyState.classList.add('hidden');
            
            list.innerHTML = todays.map(a => `
                <div class="card flex items-center justify-between">
                    <div>
                        <div class="font-bold text-2xl">${a.patient}</div>
                        <div class="text-teal-400 text-xl mt-1">${a.time}</div>
                    </div>
                    <button onclick="deleteAppointment(${a.id})" class="text-red-400 p-3 text-3xl">üóë</button>
                </div>
            `).join('');
        }
        
        function deleteAppointment(id) {
            if (!confirm('Delete?')) return;
            let appointments = JSON.parse(localStorage.getItem(getStorageKey('appointments')) || '[]');
            appointments = appointments.filter(a => a.id !== id);
            localStorage.setItem(getStorageKey('appointments'), JSON.stringify(appointments));
            loadAppointments();
            updateStats();
        }
        
        // Tasks
        function addTask() {
            const task = prompt('Task:');
            if (!task) return;
            
            let tasks = JSON.parse(localStorage.getItem(getStorageKey('tasks')) || '[]');
            tasks.push({ id: Date.now(), text: task, done: false });
            localStorage.setItem(getStorageKey('tasks'), JSON.stringify(tasks));
            loadTasks();
            updateStats();
        }
        
        function loadTasks() {
            const tasks = JSON.parse(localStorage.getItem(getStorageKey('tasks')) || '[]');
            const list = document.getElementById('tasks-list');
            
            if (tasks.length === 0) {
                list.innerHTML = '<div class="text-center text-slate-500 py-6 text-xl">No tasks</div>';
                return;
            }
            
            list.innerHTML = tasks.map(t => `
                <div class="card flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <button onclick="toggleTask(${t.id})" class="text-3xl">${t.done ? '‚úÖ' : '‚≠ï'}</button>
                        <span class="text-xl ${t.done ? 'line-through text-slate-500' : ''}">${t.text}</span>
                    </div>
                    <button onclick="deleteTask(${t.id})" class="text-red-400 p-3 text-2xl">üóë</button>
                </div>
            `).join('');
        }
        
        function toggleTask(id) {
            let tasks = JSON.parse(localStorage.getItem(getStorageKey('tasks')) || '[]');
            tasks = tasks.map(t => t.id === id ? {...t, done: !t.done} : t);
            localStorage.setItem(getStorageKey('tasks'), JSON.stringify(tasks));
            loadTasks();
            updateStats();
        }
        
        function deleteTask(id) {
            let tasks = JSON.parse(localStorage.getItem(getStorageKey('tasks')) || '[]');
            tasks = tasks.filter(t => t.id !== id);
            localStorage.setItem(getStorageKey('tasks'), JSON.stringify(tasks));
            loadTasks();
            updateStats();
        }
        
        // Patients with Zoom Call
        function renderPatientsList(patients) {
            const list = document.getElementById('patients-list');
            list.innerHTML = patients.map(p => `
                <div class="patient-card">
                    <div class="flex items-center justify-between mb-4">
                        <div class="font-bold text-2xl">${p.name}</div>
                        <button onclick="selectPatient('${p.name}', '${p.phone}')" class="text-teal-400 text-xl">üìã</button>
                    </div>
                    <button onclick="callZoom('${p.phone}')" class="btn-zoom w-full flex items-center justify-center gap-3">
                        <span class="text-2xl">üìû</span> Call in Zoom
                    </button>
                </div>
            `).join('');
        }
        
        function searchPatients(query) {
            const filtered = patientsData.filter(p => p.name.toLowerCase().includes(query.toLowerCase()));
            renderPatientsList(filtered);
        }
        
        function selectPatient(name, phone) {
            document.getElementById('patient-name').textContent = name;
            document.getElementById('patient-phone').textContent = phone;
            currentPatientPhone = phone;
            document.getElementById('patient-modal').classList.add('show');
        }
        
        function closePatientModal() {
            document.getElementById('patient-modal').classList.remove('show');
            currentPatientPhone = null;
        }
        
        function callPatientZoom() {
            if (currentPatientPhone) {
                callZoom(currentPatientPhone);
            }
        }
        
        function callZoom(phoneNumber) {
            // Clean number - keep only digits and +
            const cleanNumber = phoneNumber.replace(/[^\d+]/g, '');
            const zoomUrl = `zoomphonecall:${cleanNumber}`;
            
            // Try to open Zoom
            window.location.href = zoomUrl;
            
            // Fallback after 500ms if app not installed
            setTimeout(() => {
                alert('Open Zoom Workplace app to call');
            }, 500);
        }
        
        // Stats
        function updateStats() {
            const appointments = JSON.parse(localStorage.getItem(getStorageKey('appointments')) || '[]');
            const tasks = JSON.parse(localStorage.getItem(getStorageKey('tasks')) || '[]');
            const today = new Date().toISOString().split('T')[0];
            
            document.getElementById('stat-today').textContent = appointments.filter(a => a.date === today).length;
            document.getElementById('stat-tasks').textContent = tasks.filter(t => !t.done).length;
            document.getElementById('stat-recalls').textContent = '0';
        }
        
        // Install
        function addToHomeScreen() {
            if (navigator.share) {
                navigator.share({ title: 'Elixir', url: window.location.href });
            } else {
                alert('Tap Share ‚Üí Add to Home Screen');
            }
        }
        
        // Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('data:text/javascript;base64,' + btoa(`
                self.addEventListener('install', e => self.skipWaiting());
                self.addEventListener('activate', e => e.waitUntil(clients.claim()));
                self.addEventListener('fetch', e => e.respondWith(fetch(e.request).catch(() => new Response('Offline'))));
            `)).catch(() => {});
        }
    </script>
</body>
</html>